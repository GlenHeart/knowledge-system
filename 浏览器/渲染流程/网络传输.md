# 浏览器渲染

> 多进程和单进程的优缺点

- 单进程 容易阻塞 某个线程奔溃导致浏览器 页面内存泄露会导致浏览器变慢
- 单进程 插件线程可以直接访问浏览器进程，不安全
- 单进程 架构简单， 进程退出，即使子线程内存泄露了也能回收
- 多进程架构复杂，各个进程通过ipc通信 但是不会那么容易出现浏览器奔溃的情况
- 多进程需要更高的内存占用

> chrome多进程基本组成

  1. 浏览器主进程 渲染进程(sandbox) 插件进程 网络进程 GPU进程
  2. 页面进程 同一网址共用一个
  3. network

> 网络传输

- 网络层级
  1. 应用层 http
  2. 传输层 （tcp, udp）应用程序
  3. 网络层 路由 主机之间
  4. 数据链路层 ip数据报 解封和封装
  5. 物理层 物理传输
  6. udp 端口 速度快，但是丢包可能性大
     tcp 添加完整性校验。接口速度相对较慢。发包后服务器会返回是否接收到了，丢包后会重新发送

- tcp三次握手4次挥手
  1. tcp连接

> 页面加载过程

- 导航栏输入url, network
  1. 构建请求行
  2. 查找缓存(dns缓存 页面缓存)
  3. 转变ip和端口 网络层
  4. tcp等待队列 浏览器最大6次tcp连接
  5. tcp连接
  6. http请求
  7. 服务器处理请求
  8. 服务器响应
  9. 缓存是否更新，返回304(if-none-match) 刷新缓存时间
  10. 断开连接
- 接收服务器响应头
- 渲染流程准备
- 接收响应体, 提交文档
- 下载页面资源
